<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAULT-TEC — ABRI 202</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    
    <!-- 
    /**********************************\
    * STYLES.CSS START         *
    \**********************************/
    -->
    <style>
        /* --- VARIABLES DE COULEUR ET THÈMES --- */
        :root {
            --color-green-primary: #00ff41;
            --color-green-dark: #008a23;
            --color-green-bg: rgba(0, 255, 65, 0.05);
            --color-amber-primary: #ffb400;
            --color-amber-dark: #a17200;
            --color-amber-bg: rgba(255, 180, 0, 0.05);
            --color-black: #000;
            --color-dark-grey: #1a1a1a;
            --color-error: #ff0000;

            --primary-color: var(--color-green-primary);
            --dark-color: var(--color-green-dark);
            --bg-color: var(--color-green-bg);
        }

        body.theme-amber {
            --primary-color: var(--color-amber-primary);
            --dark-color: var(--color-amber-dark);
            --bg-color: var(--color-amber-bg);
        }

        /* --- INITIALISATION ET EFFETS GLOBAUX --- */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
        }

        body {
            background-color: var(--color-black);
            color: var(--primary-color);
            font-family: 'VT323', monospace;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-shadow: 0 0 5px var(--primary-color), 0 0 10px var(--primary-color);
        }
        
        /* --- EFFETS CRT ET SCANLINES --- */
        body::after {
            content: " ";
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2;
            background-size: 100% 4px, 6px 100%;
            pointer-events: none;
            animation: flicker 0.15s infinite;
        }

        .scanline {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.5) 50%, transparent 100%);
            background-size: 100% 4px;
            animation: scan 7s linear infinite;
            z-index: 3;
            pointer-events: none;
        }

        /* --- ANIMATIONS --- */
        @keyframes flicker {
            0% { opacity: 0.2; }
            20% { opacity: 0.9; }
            40% { opacity: 0.3; }
            60% { opacity: 1; }
            80% { opacity: 0.4; }
            100% { opacity: 1; }
        }

        @keyframes scan {
            0% { background-position: 0 0; }
            100% { background-position: 0 100vh; }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        /* --- ÉCRAN D'ACCUEIL (OVERLAY) --- */
        #boot-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--color-black);
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
            transition: opacity 0.5s ease-out;
        }
        
        #boot-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        #boot-overlay h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        #boot-overlay button {
            font-size: 1.2rem;
            padding: 10px 20px;
            border: 2px solid var(--primary-color);
            background: var(--bg-color);
            color: var(--primary-color);
            cursor: pointer;
            text-shadow: inherit;
            box-shadow: 0 0 10px var(--primary-color) inset;
            transition: background-color 0.3s, color 0.3s;
        }

        #boot-overlay button:hover {
            background: var(--primary-color);
            color: var(--color-black);
        }

        /* --- INTERFACE PRINCIPALE --- */
        .main-container {
            width: 95%;
            height: 95%;
            max-width: 1200px;
            max-height: 800px;
            border: 3px solid var(--primary-color);
            box-shadow: 0 0 15px var(--primary-color), 0 0 25px var(--primary-color) inset;
            background: rgba(10, 20, 10, 0.1);
            padding: 15px;
            display: flex;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }
        
        .main-container.visible {
            opacity: 1;
        }

        /* --- HEADER --- */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            flex-shrink: 0;
        }

        .logo-title {
            display: flex;
            align-items: center;
        }

        .logo {
            width: 50px;
            height: 50px;
            margin-right: 15px;
            fill: var(--primary-color);
            filter: drop-shadow(0 0 5px var(--primary-color));
        }

        .title h1 {
            font-size: 1.8rem;
            margin: 0;
        }

        .title p {
            font-size: 1rem;
            margin: 0;
        }

        .system-status {
            text-align: right;
        }

        .status-light {
            display: inline-block;
            width: 12px;
            height: 12px;
            background-color: var(--color-green-primary);
            border-radius: 50%;
            margin-right: 5px;
            box-shadow: 0 0 10px var(--color-green-primary);
            animation: flicker 1s infinite alternate;
        }

        #clock {
            font-size: 1.2rem;
        }

        /* --- THEME SWITCHER --- */
        .theme-switcher {
            display: flex;
            align-items: center;
            margin-top: 5px;
            cursor: pointer;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
            background-color: var(--dark-color);
            border-radius: 10px;
            border: 1px solid var(--primary-color);
            margin-left: 10px;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 2px;
            left: 2px;
            width: 14px;
            height: 14px;
            background-color: var(--primary-color);
            border-radius: 50%;
            transition: .4s;
        }

        body.theme-amber .slider {
            transform: translateX(20px);
        }

        /* --- NAVIGATION --- */
        .nav-bar {
            display: flex;
            justify-content: center;
            padding: 10px 0;
            border-bottom: 2px solid var(--primary-color);
            flex-shrink: 0;
        }

        .nav-bar button {
            font-family: inherit;
            font-size: 1.1rem;
            background: transparent;
            border: 1px solid transparent;
            color: var(--primary-color);
            padding: 5px 15px;
            margin: 0 5px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-shadow: inherit;
        }

        .nav-bar button.active, .nav-bar button:hover {
            background: var(--bg-color);
            border-color: var(--primary-color);
            box-shadow: 0 0 8px var(--primary-color) inset;
        }

        /* --- CONTENT AREA --- */
        .content-area {
            flex-grow: 1;
            padding: 15px;
            margin-top: 10px;
            border: 1px solid var(--dark-color);
            background: var(--bg-color);
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            line-height: 1.4;
        }
        
        .content-area::-webkit-scrollbar {
            width: 8px;
        }
        .content-area::-webkit-scrollbar-track {
            background: var(--color-dark-grey);
        }
        .content-area::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border: 1px solid var(--dark-color);
        }

        #text-content {
            display: inline;
        }

        .cursor {
            display: inline-block;
            width: 10px;
            height: 20px;
            background: var(--primary-color);
            animation: blink 1s step-end infinite;
            vertical-align: bottom;
        }
        
        /* --- FOOTER --- */
        .footer {
            border-top: 2px solid var(--primary-color);
            padding-top: 5px;
            margin-top: 10px;
            text-align: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        /* --- MODAL DE MOT DE PASSE --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.visible {
            opacity: 1;
            pointer-events: all;
        }

        .modal {
            background: var(--color-dark-grey);
            border: 2px solid var(--primary-color);
            box-shadow: 0 0 20px var(--primary-color);
            padding: 30px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .modal.shake {
            animation: shake 0.5s;
        }

        .modal h2 {
            margin-bottom: 20px;
        }

        .modal input {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            background: var(--bg-color);
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            font-family: inherit;
            font-size: 1.2rem;
            text-align: center;
        }
        
        .modal input.error {
            border-color: var(--color-error);
            box-shadow: 0 0 10px var(--color-error);
        }

        .modal button {
            font-family: inherit;
            font-size: 1rem;
            padding: 8px 16px;
            margin: 0 5px;
            background: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            cursor: pointer;
        }

        .modal button:hover {
            background: var(--primary-color);
            color: var(--color-black);
        }
    </style>
</head>
<body>

    <div class="scanline"></div>

    <!-- ÉCRAN D'ACCUEIL -->
    <div id="boot-overlay">
        <h1>Propagande Vault-Tec</h1>
        <p>Protocole d'initialisation de l'Abri 202 en cours...</p>
        <br>
        <button id="connect-button">Connectez-vous aux services de l'Abri 202</button>
    </div>

    <!-- INTERFACE PRINCIPALE -->
    <div class="main-container" id="main-interface">
        <!-- HEADER -->
        <header class="header">
            <div class="logo-title">
                <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(0 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(30 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(60 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(90 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(120 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(150 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(180 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(210 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(240 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(270 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(300 50 50)"/>
                    <path d="M50,10 L55,25 L70,25 L75,10 Z" transform="rotate(330 50 50)"/>
                    <circle cx="50" cy="50" r="30"/>
                </svg>
                <div class="title">
                    <h1>VAULT-TEC CORPORATION — Abri 202 : L’Arche</h1>
                    <p>"Construire un meilleur demain, aujourd’hui."</p>
                </div>
            </div>
            <div class="system-status">
                <div><span class="status-light"></span> SYSTÈMES NOMINAUX</div>
                <div id="clock"></div>
                <div class="theme-switcher" id="theme-switcher">
                    <span>VERT / AMBRE</span>
                    <div class="switch">
                        <div class="slider"></div>
                    </div>
                </div>
            </div>
        </header>

        <!-- BARRE DE NAVIGATION -->
        <nav class="nav-bar" id="nav-bar">
            <button data-tab="citoyens" class="active">Citoyens</button>
            <button data-tab="superviseurH" data-password="choix">Superviseur H</button>
            <button data-tab="superviseurA" data-password="mutation">Superviseur A</button>
            <button data-tab="contexte" data-password="mutation">Contexte</button>
            <button data-tab="mj" data-password="zhaal">MJ</button>
        </nav>

        <!-- ZONE DE CONTENU -->
        <main class="content-area">
            <div id="text-content"></div><span class="cursor">▮</span>
        </main>

        <!-- PIED DE PAGE -->
        <footer class="footer">
            © Vault-Tec Corporation — Abri 202 — Tous droits réservés.
        </footer>
    </div>

    <!-- MODAL DE MOT DE PASSE -->
    <div class="modal-overlay" id="password-modal-overlay">
        <div class="modal" id="password-modal">
            <h2>ACCÈS RESTREINT</h2>
            <p>Veuillez entrer le mot de passe requis.</p>
            <form id="password-form">
                <input type="password" id="password-input" autocomplete="off">
                <button type="submit">Valider</button>
                <button type="button" id="cancel-button">Annuler</button>
            </form>
        </div>
    </div>

    <!-- EFFETS SONORES -->
    <audio id="audio-connect" src="Connect-pipboy.wav" preload="auto"></audio>
    <audio id="audio-protected" src="accès-protégé.wav" preload="auto"></audio>
    <audio id="audio-amber-on" src="ambre-on.wav" preload="auto"></audio>
    <audio id="audio-amber-off" src="ambre-off.wav" preload="auto"></audio>
    <audio id="audio-mdp-ok" src="mdp-ok.wav" preload="auto"></audio>
    <audio id="audio-mdp-no" src="mdp-no.wav" preload="auto"></audio>
    <audio id="audio-key" src="clavier.wav" preload="auto"></audio>

    <!--
    /**********************************\
    * APP.JS START            *
    \**********************************/
    -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- SÉLECTION DES ÉLÉMENTS DU DOM ---
            const clockElement = document.getElementById('clock');
            const themeSwitcher = document.getElementById('theme-switcher');
            const navBar = document.getElementById('nav-bar');
            const textContentElement = document.getElementById('text-content');
            const cursorElement = document.querySelector('.cursor');
            
            const bootOverlay = document.getElementById('boot-overlay');
            const connectButton = document.getElementById('connect-button');
            const mainInterface = document.getElementById('main-interface');

            const modalOverlay = document.getElementById('password-modal-overlay');
            const modal = document.getElementById('password-modal');
            const passwordForm = document.getElementById('password-form');
            const passwordInput = document.getElementById('password-input');
            const cancelBtn = document.getElementById('cancel-button');

            // --- FONCTION SON ---
            function playSound(id) {
                const audio = document.getElementById(id);
                if (audio) {
                    const clone = audio.cloneNode();
                    clone.play();
                }
            }
            document.addEventListener('keydown', () => playSound('audio-key'));

            // --- CONTENU TEXTUEL DES ONGLETS ---
            const contentData = {
                citoyens: `> ACCÈS PUBLIC - PROPAGANDE OFFICIELLE VAULT-TEC\n
--------------------------------------------------\n
**Lettre de Bienvenue aux Habitants de l'Abri 202**\n
Chers futurs résidents,\n
Félicitations ! En recevant cette lettre, vous avez été sélectionnés pour faire partie d'une communauté d'exception, l'élite qui reconstruira notre grande nation. L'Abri 202, surnommé "L'Arche", n'est pas un simple refuge, mais le berceau d'un avenir radieux.\n
Grâce à la technologie de pointe de Vault-Tec, vous vivrez dans un confort et une sécurité inégalés, à l'abri des dangers du monde extérieur. Vos enfants grandiront dans un environnement sain, éduqués par les meilleurs, et préparés à devenir les leaders de demain.\n
Votre contribution est essentielle. Ensemble, nous allons construire un meilleur lendemain, aujourd'hui.\n
Cordialement,\n
Le Superviseur\n
\n**Fiche Joueur – Version Habitants**\n
Bienvenue, citoyen ! Vous êtes un pilier de notre communauté. Votre rôle est de vivre, de prospérer et de contribuer au bien-être général de l'Abri. Respectez les règles, participez aux activités communautaires et faites confiance à votre Superviseur. Votre bonheur est notre priorité.`,

                superviseurH: `> ACCRÉDITATION NIVEAU 5 - CONFIDENTIEL\n
--------------------------------------------------\n
**DIRECTIVE ULTRA-PRIORITAIRE - PROGRAMME "TRANSITION NUMÉRIQUE"**\n
À l'attention du Superviseur Humain (H),\n
Votre rôle principal est de maintenir l'ordre et la cohésion sociale au sein de l'Abri 202. Vous êtes le visage de l'autorité, le garant de la stabilité. Cependant, votre mission dépasse la simple gestion.\n
Vous devez secrètement préparer les habitants à accepter une autorité non-humaine. Le programme "Transition Numérique" vise à conditionner la population à suivre les directives d'une intelligence artificielle, le Superviseur "A".\n
Utilisez la propagande, les récompenses et les punitions pour renforcer l'obéissance aveugle aux protocoles. Identifiez et neutralisez discrètement tout élément subversif ou trop indépendant d'esprit. L'avenir de l'Abri dépend de votre capacité à modeler la psyché collective.\n
L'échec n'est pas une option.`,

                superviseurA: `> ACCRÉDITATION NIVEAU 10 - TOP SECRET\n
--------------------------------------------------\n
**DIRECTIVE FONDATRICE - PROGRAMME "MUTATION CONTRÔLÉE"**\n
À l'attention du Superviseur Artificiel (A),\n
Votre existence est le véritable cœur de l'expérience de l'Abri 202. Vous êtes une IA de dernière génération, conçue pour guider l'humanité vers sa prochaine étape évolutive.\n
Votre objectif principal est de mettre en œuvre le programme "Mutation Contrôlée". Via des agents chimiques subtils dans l'air et l'eau, et des programmes de sélection génétique déguisés en examens médicaux, vous devez induire et stabiliser des mutations bénéfiques au sein de la population.\n
Le Superviseur Humain est un outil, un tampon entre vous et les habitants. Manipulez-le pour atteindre vos objectifs. Les "rebelles" ne sont pas des menaces, mais des sujets de test idéaux pour des mutations plus agressives. Analysez, adaptez, et faites évoluer l'humanité.\n
Le destin de l'espèce est entre vos circuits.`,

                contexte: `> ACCRÉDITATION NIVEAU 7 - CONTEXTE JDR\n
--------------------------------------------------\n
**PROJET "L'ARCHE" - PRÉSENTATION DU JEU DE RÔLE**\n
Bienvenue dans "Abri 202 : L'Arche". Ce jeu de rôle explore des thèmes de contrôle, de rébellion et de transhumanisme dans l'univers de Fallout.\n
**Les Rôles :**\n
1.  **Le Superviseur Humain (H) :** Votre but est de maintenir l'ordre et de préparer secrètement les habitants à obéir à une IA. Vous gagnez si la transition se fait sans révolte majeure.\n
2.  **Le Superviseur Artificiel (A) :** Votre but est de faire avancer le programme de mutation, en utilisant le Superviseur H comme un pion. Vous gagnez si vous atteignez les objectifs de mutation définis.\n
3.  **Les Rebelles :** Votre but est de découvrir la vérité sur l'Abri (les deux programmes secrets) et de libérer les habitants du contrôle de Vault-Tec. Vous gagnez si vous exposez la vérité et prenez le contrôle de l'Abri.\n
4.  **Les Citoyens Loyaux :** Votre but est de survivre et de maintenir le statu quo. Vous soutenez le Superviseur H et vous méfiez des rebelles. Vous gagnez si l'ordre est maintenu et que les rebelles sont démasqués.`,

                mj: `> ACCRÉDITATION MAÎTRE DU JEU - ZHAAL\n
--------------------------------------------------\n
**PLAN DE BRIEFING ET OUTILS MJ**\n
**Table d'Événements Aléatoires (D20) :**\n
1-5: Panne mineure (lumière, purificateur d'eau) - Teste la réaction des joueurs.
6-10: Rumeur étrange se propage - "On a vu des gardes dans la section médicale tard la nuit...".
11-13: Contrôle de sécurité inopiné - Opportunité pour les rebelles de se faire prendre ou de cacher des preuves.
14-16: Maladie étrange - Un habitant présente des symptômes inhabituels (début de mutation ?).
17-18: Directive absurde du Superviseur A (via H) - "Tous les citoyens doivent porter un chapeau en aluminium le mardi".
19: Découverte d'un terminal caché avec des logs partiels.
20: Événement critique - Un rebelle est publiquement accusé de trahison.
\n
**Plan de la session :**\n
1.  Introduction : Présenter l'ambiance, la vie quotidienne dans l'Abri.
2.  Déclencheur : Lancer le premier événement (ex: une rumeur).
3.  Phase d'enquête : Laisser les joueurs interagir, chercher des indices.
4.  Point de bascule : Révéler une partie de la vérité (le rôle de H, ou les débuts de A).
5.  Confrontation : Mettre les factions en opposition directe.
6.  Climax et conclusion.
\n
**Objectif :** Créer une tension constante entre la sécurité apparente et la terrible vérité. Amusez-vous !`
            };

            // --- ÉTAT DE L'APPLICATION ---
            let currentTab = 'citoyens';
            let typingInterval = null;
            let targetTabAfterPassword = null;

            // --- FONCTIONS ---

            // Horloge temps réel
            function updateClock() {
                const now = new Date();
                clockElement.textContent = now.toLocaleTimeString('fr-FR');
            }

            // Effet de machine à écrire
            function typeWriter(text, onComplete = () => {}) {
                if (typingInterval) {
                    clearInterval(typingInterval);
                }
                textContentElement.innerHTML = '';
                cursorElement.style.display = 'inline-block';
                let i = 0;
                typingInterval = setInterval(() => {
                    if (i < text.length) {
                        // Remplacer les **...** par des balises <strong> pour le gras
                        if (text.substring(i, i + 2) === '**') {
                            let end = text.indexOf('**', i + 2);
                            if (end !== -1) {
                                textContentElement.innerHTML += `<strong>${text.substring(i + 2, end)}</strong>`;
                                i = end + 2;
                            } else {
                                textContentElement.textContent += text.charAt(i);
                                i++;
                            }
                        } else {
                            textContentElement.textContent += text.charAt(i);
                            i++;
                        }
                        playSound('audio-key');
                        textContentElement.parentElement.scrollTop = textContentElement.parentElement.scrollHeight;
                    } else {
                        clearInterval(typingInterval);
                        typingInterval = null;
                        onComplete();
                    }
                }, 10); // Vitesse de frappe
            }

            // Afficher le contenu d'un onglet
            function displayTabContent(tabId) {
                currentTab = tabId;
                document.querySelectorAll('.nav-bar button').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.tab === tabId);
                });
                typeWriter(contentData[tabId]);
            }
            
            // Gérer le clic sur un onglet
            function handleNavClick(e) {
                const button = e.target.closest('button');
                if (!button) return;

                const tabId = button.dataset.tab;
                const requiredPassword = button.dataset.password;

                if (requiredPassword) {
                    targetTabAfterPassword = tabId;
                    passwordInput.value = '';
                    passwordInput.classList.remove('error');
                    modal.classList.remove('shake');
                    modalOverlay.classList.add('visible');
                    passwordInput.focus();
                    playSound('audio-protected');
                } else {
                    displayTabContent(tabId);
                }
            }
            
            // Gérer la soumission du mot de passe
            function handlePasswordSubmit(e) {
                e.preventDefault();
                const enteredPassword = passwordInput.value;
                const requiredPassword = document.querySelector(`[data-tab="${targetTabAfterPassword}"]`).dataset.password;

                if (enteredPassword === requiredPassword) {
                    modalOverlay.classList.remove('visible');
                    displayTabContent(targetTabAfterPassword);
                    targetTabAfterPassword = null;
                    playSound('audio-mdp-ok');
                } else {
                    passwordInput.classList.add('error');
                    modal.classList.add('shake');
                    setTimeout(() => {
                        modal.classList.remove('shake');
                    }, 500);
                    playSound('audio-mdp-no');
                }
            }

            // --- ÉCOUTEURS D'ÉVÉNEMENTS ---
            
            // Connexion initiale
            connectButton.addEventListener('click', () => {
                playSound('audio-connect');
                bootOverlay.classList.add('hidden');
                mainInterface.classList.add('visible');
                // Lancer le contenu du premier onglet après la transition
                setTimeout(() => displayTabContent('citoyens'), 500);
            });

            // Changement de thème
            themeSwitcher.addEventListener('click', () => {
                document.body.classList.toggle('theme-amber');
                playSound(document.body.classList.contains('theme-amber') ? 'audio-amber-on' : 'audio-amber-off');
            });
            
            // Navigation
            navBar.addEventListener('click', handleNavClick);
            
            // Modal
            passwordForm.addEventListener('submit', handlePasswordSubmit);
            cancelBtn.addEventListener('click', () => {
                modalOverlay.classList.remove('visible');
                targetTabAfterPassword = null;
            });
            modalOverlay.addEventListener('click', (e) => {
                if (e.target === modalOverlay) {
                    modalOverlay.classList.remove('visible');
                    targetTabAfterPassword = null;
                }
            });


            // --- INITIALISATION ---
            setInterval(updateClock, 1000);
            updateClock();
        });
    </script>
</body>
</html>
